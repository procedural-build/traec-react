buildPack: none
pipelineConfig:
  pipelines:
    release:
      pipeline:
        agent:
          image: node:10-slim
        stages:
          - name: NPM INSTALL
            steps:
              - command: npm install
          - name: TEST
            steps:
              - command: npm test -- --ci --coverage --testResultsProcessor="jest-junit"
          - name: Release to NPM
            steps:
              - command: echo $SECRET
              - command: echo "//registry.npmjs.org/:_authToken=${SECRET}" > ~/.npmrc
              - command: npm run matchversion
              - command: npm run patchversion
              - command: npm run pub
    pullRequest:
      pipeline:
        agent:
          image: node:10-slim
        stages:
          - name: NPM INSTALL
            steps:
              - command: npm install
          - name: TEST
            steps:
              - command: npm test -- --ci --coverage --testResultsProcessor="jest-junit"
